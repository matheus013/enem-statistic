# -*- coding: utf-8 -*-
"""Enem.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1fSIVA_rbq5vRmYXDlyCpzldJ-eqxiDT4
"""

import pandas as pd

path = 'data'
names = pd.read_excel(path + '/names.xlsx')


def get_filename(year):
    return path + '/{}.xlsx'.format(year)


def get_dict_from_year(year):
    result = {}
    for index, row in names.iterrows():
        print(row, year)
        if row[year] == '':
            continue
        result[row[year]] = row['novo']
    return result


data_input = []

for i in range(2009, 2020):
    print(path + '/{}.xlsx'.format(i), 'carregando.')
    df = pd.read_excel(path + '/{}.xlsx'.format(i))
    df.rename(columns=get_dict_from_year(i), inplace=True)
    df.to_parquet(path + '/{}.parquet'.format(i))
    print(path + '/{}.parquet'.format(i), 'salvo com sucesso')

# names = pd.read_excel(path + '/names.xlsx')
#
# print('renamed')
#
# merged = pd.concat(data_input)
#
# print('merged')

# merged.to_csv(path + 'export_dataframe.csv', index=False, header=True)
